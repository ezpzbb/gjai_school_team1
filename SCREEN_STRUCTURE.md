# Palantir 프로젝트 화면 구조 문서

## 📋 목차
1. [전체 구조 개요](#전체-구조-개요)
2. [프론트엔드 구조](#프론트엔드-구조)
3. [백엔드 구조](#백엔드-구조)
4. [화면 구조도](#화면-구조도)
5. [페이지별 컴포넌트 계층 구조](#페이지별-컴포넌트-계층-구조)
6. [페이지별 기능 구성](#페이지별-기능-구성-차트-형태)
7. [메뉴 구성 화면](#메뉴-구성-화면-탑-다운-방식)
8. [플로우 차트](#플로우-차트)
9. [화면별 상세 구조](#화면별-상세-구조)
10. [컴포넌트 계층 구조](#컴포넌트-계층-구조)
11. [라우팅 구조](#라우팅-구조)

---

## 전체 구조 개요

```
Palantir (CCTV 모니터링 시스템)
├── Frontend (React + TypeScript + Vite)
│   ├── Pages (5개 페이지)
│   ├── Components (재사용 컴포넌트)
│   ├── Providers (Context API)
│   ├── Services (API 통신)
│   └── Utils (유틸리티)
└── Backend (Node.js + Express + TypeScript)
    ├── Routes (API 엔드포인트)
    ├── Models (데이터베이스 모델)
    ├── Services (비즈니스 로직)
    └── Socket.IO (실시간 통신)
```

---

## 프론트엔드 구조

### 1. Provider 계층 구조 (최상위)

```
main.tsx
└── ThemeProvider (다크모드)
    └── AppProvider (앱 전역 설정)
        └── AuthProvider (인증 상태)
            └── NotificationProvider (알림 관리)
                └── DataProvider (CCTV 데이터)
                    └── BrowserRouter
                        └── App.tsx
```

### 2. 페이지 구조

```
App.tsx
├── Routes
│   ├── / (MainPage - 레이아웃)
│   │   ├── /home (Home - 홈 페이지)
│   │   ├── /dashboard (DashBoardPage - 대시보드)
│   │   ├── /kakao-map (KakaoMapPage - 지도)
│   │   └── /favorite (FavoritePage - CCTV 관리)
│   └── /auth/login (LoginForm - 로그인)
└── NotificationContainer (전역 알림)
```

---

## 화면 구조도

### 전체 레이아웃 구조

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                                    Header                                    │
│  [Palantir]  [대시보드] [지도] [CCTV]  [🔔] [🌙] [사용자명 ▼]              │
└─────────────────────────────────────────────────────────────────────────────┘
┌──────┬──────────────────────────────────────────────────────────────┬──────┐
│      │                                                              │      │
│ Side │                                                              │ Dash │
│ bar  │                      Main Content Area                        │ board│
│      │                    (페이지별 콘텐츠)                          │      │
│ [📊] │                                                              │ [즐겨│
│ [🗺️] │                                                              │ 찾기]│
│ [📹] │                                                              │      │
│ [⚙️] │                                                              │ [최신│
│      │                                                              │ 이벤트│
│      │                                                              │      │
└──────┴──────────────────────────────────────────────────────────────┴──────┘
```

### 1. 로그인 페이지 구조

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                                                                               │
│                          [Palantir 로고]                                      │
│                                                                               │
│                    ┌─────────────────────────────┐                          │
│                    │  [로그인] [회원가입]          │                          │
│                    └─────────────────────────────┘                          │
│                                                                               │
│                    ┌─────────────────────────────┐                          │
│                    │  아이디/이메일: [        ]    │                          │
│                    │  비밀번호:     [        ]    │                          │
│                    │                             │                          │
│                    │        [로그인 버튼]          │                          │
│                    └─────────────────────────────┘                          │
│                                                                               │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 2. 대시보드 페이지 구조

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                                    Header                                    │
└─────────────────────────────────────────────────────────────────────────────┘
┌──────┬──────────────────────────────────────────────────────────────┬──────┐
│      │                                                              │      │
│ Side │  ┌────────────────────────────────────────────────────┐    │ Dash │
│ bar  │  │  CCTV: [드롭다운 ▼]  시간대: [드롭다운 ▼] [보고서] │    │ board│
│      │  └────────────────────────────────────────────────────┘    │      │
│      │                                                              │ [즐겨│
│      │  ┌────────────────────────────────────────────────────┐    │ 찾기]│
│      │  │                                                    │    │      │
│      │  │         혼잡도 차트 (Line Chart)                   │    │ [최신│
│      │  │                                                    │    │ 이벤트│
│      │  │                                                    │    │      │
│      │  └────────────────────────────────────────────────────┘    │      │
│      │                                                              │      │
│      │  ┌──────────────────────┐  ┌──────────────────────┐     │      │
│      │  │                      │  │                      │     │      │
│      │  │  차량 수 차트        │  │  객체 유형 차트      │     │      │
│      │  │  (Bar Chart)         │  │  (Doughnut Chart)    │     │      │
│      │  │                      │  │                      │     │      │
│      │  └──────────────────────┘  └──────────────────────┘     │      │
│      │                                                              │      │
└──────┴──────────────────────────────────────────────────────────────┴──────┘
```

### 3. 지도 페이지 구조

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                                    Header                                    │
└─────────────────────────────────────────────────────────────────────────────┘
┌──────┬──────────────────────────────────────────────────────────────┬──────┐
│      │                                                              │      │
│ Side │  ┌────────────────────────────────────────────────────┐    │ Dash │
│ bar  │  │  [🔍 검색: CCTV 위치 검색...]                        │    │ board│
│      │  └────────────────────────────────────────────────────┘    │      │
│      │                                                              │ [즐겨│
│      │  ┌────────────────────────────────────────────────────┐    │ 찾기]│
│      │  │                                                    │    │      │
│      │  │                                                    │    │ [최신│
│      │  │              카카오맵 (지도)                        │    │ 이벤트│
│      │  │                                                    │    │      │
│      │  │         📍 CCTV 마커들                              │    │      │
│      │  │         ⚠️ 이벤트 마커들                            │    │      │
│      │  │                                                    │    │      │
│      │  └────────────────────────────────────────────────────┘    │      │
│      │                                                              │      │
│      │  ┌────────────────────────────────────────────────────┐    │      │
│      │  │  📍 위치: 호남대캠퍼스사거리  [🔍] [⛶] [★]        │    │      │
│      │  │  ┌──────────────────────────────────────────────┐  │    │      │
│      │  │  │                                              │  │    │      │
│      │  │  │         CCTV 영상 플레이어                    │  │    │      │
│      │  │  │                                              │  │    │      │
│      │  │  └──────────────────────────────────────────────┘  │    │      │
│      │  └────────────────────────────────────────────────────┘    │      │
│      │                                                              │      │
└──────┴──────────────────────────────────────────────────────────────┴──────┘
```

### 4. CCTV 페이지 구조

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                                    Header                                    │
└─────────────────────────────────────────────────────────────────────────────┘
┌──────┬──────────────────────────────────────────────────────────────┬──────┐
│      │                                                              │      │
│ Side │  [분석 모드: OFF] [분석 시작]                                 │ Dash │
│ bar  │                                                              │ board│
│      │  ┌──────────────────────┐  ┌──────────────────────┐     │      │
│      │  │ 📹 CCTV 1            │  │ 📹 CCTV 2            │     │ [즐겨│
│      │  │ [위치] [🔍] [⛶] [★] │  │ [위치] [🔍] [⛶] [★] │     │ 찾기]│
│      │  │ ┌──────────────────┐ │  │ ┌──────────────────┐ │     │      │
│      │  │ │                  │ │  │ │                  │ │     │ [최신│
│      │  │ │   영상 플레이어   │ │  │ │   영상 플레이어   │ │     │ 이벤트│
│      │  │ │                  │ │  │ │                  │ │     │      │
│      │  │ └──────────────────┘ │  │ └──────────────────┘ │     │      │
│      │  └──────────────────────┘  └──────────────────────┘     │      │
│      │                                                              │      │
│      │  ┌──────────────────────┐  ┌──────────────────────┐     │      │
│      │  │ 📹 CCTV 3            │  │ 📹 CCTV 4            │     │      │
│      │  │ [위치] [🔍] [⛶] [★] │  │ [위치] [🔍] [⛶] [★] │     │      │
│      │  │ ┌──────────────────┐ │  │ ┌──────────────────┐ │     │      │
│      │  │ │                  │ │  │ │                  │ │     │      │
│      │  │ │   영상 플레이어   │ │  │ │   영상 플레이어   │ │     │      │
│      │  │ │                  │ │  │ │                  │ │     │      │
│      │  │ └──────────────────┘ │  │ └──────────────────┘ │     │      │
│      │  └──────────────────────┘  └──────────────────────┘     │      │
│      │                                                              │      │
└──────┴──────────────────────────────────────────────────────────────┴──────┘
```

### 5. 홈 페이지 구조

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                                    Header                                    │
└─────────────────────────────────────────────────────────────────────────────┘
┌──────┬──────────────────────────────────────────────────────────────┬──────┐
│      │                                                              │      │
│ Side │                                                              │ Dash │
│ bar  │                    CCTV 지도                                  │ board│
│      │                                                              │      │
│      │                                                              │ [즐겨│
│      │                                                              │ 찾기]│
│      │                                                              │      │
│      │                                                              │ [최신│
│      │                                                              │ 이벤트│
│      │                                                              │      │
└──────┴──────────────────────────────────────────────────────────────┴──────┘
```

---

## 페이지별 컴포넌트 계층 구조

### 1. 대시보드 페이지 (/dashboard)

```
Palantir
└── DashBoardPage
    ├── DashboardHeader - CCTV 선택, 시간대 선택, 보고서 출력
    ├── 에러 메시지 영역 - 에러 표시
    ├── 빈 상태 영역 - 안내 메시지 표시
    └── 차트 영역
        ├── CongestionChart - 혼잡도 데이터 시각화
        ├── VehicleCountChart - 차량 통계 시각화
        └── ObjectTypeChart - 객체 유형 통계 시각화
```

```
┌─────────────────────────────────────────────────────────────┐
│                    대시보드 페이지                            │
├─────────────────────────────────────────────────────────────┤
│                                                              │
│  ┌──────────────────────────────────────────────────────┐  │
│  │  헤더 영역                                            │  │
│  │  ┌──────────────┐  ┌──────────────┐  ┌───────────┐ │  │
│  │  │ CCTV 선택    │  │ 시간대 선택   │  │ 보고서 출력│ │  │
│  │  │ (드롭다운)    │  │ (드롭다운)    │  │ (버튼)    │ │  │
│  │  └──────────────┘  └──────────────┘  └───────────┘ │  │
│  └──────────────────────────────────────────────────────┘  │
│                                                              │
│  ┌──────────────────────────────────────────────────────┐  │
│  │  차트 영역                                            │  │
│  │                                                       │  │
│  │  ┌───────────────────────────────────────────────┐   │  │
│  │  │  혼잡도 차트 (큰 차트)                         │   │  │
│  │  │  - 시간별 혼잡도 추이                          │   │  │
│  │  └───────────────────────────────────────────────┘   │  │
│  │                                                       │  │
│  │  ┌──────────────────────┐  ┌────────────────────┐  │  │
│  │  │ 차량 통계 차트        │  │ 객체 유형 차트      │  │  │
│  │  │ - 시간별 차량 수      │  │ - 차량/보행자 등    │  │  │
│  │  └──────────────────────┘  └────────────────────┘  │  │
│  └──────────────────────────────────────────────────────┘  │
│                                                              │
└─────────────────────────────────────────────────────────────┘

기능:
  ├─ CCTV 선택 기능
  │   └─ 즐겨찾기 CCTV 목록에서 선택
  ├─ 시간대 선택 기능
  │   └─ 분석 완료된 시간대 목록 표시 및 선택
  ├─ 혼잡도 차트
  │   └─ 선택한 시간대의 혼잡도 데이터 시각화
  ├─ 차량 통계 차트
  │   └─ 선택한 시간대의 차량 수 통계 시각화
  ├─ 객체 유형 차트
  │   └─ 선택한 시간대의 객체 유형별 통계 시각화
  └─ 보고서 출력 기능 (추후 구현)
```

### 2. 카카오맵 페이지 (/kakao-map)

```
Palantir
└── KakaoMapPage
    ├── MapProvider - 지도 상태 관리
    ├── Dashboard - 즐겨찾기, 최신 이벤트 목록 표시
    └── KakaoMap
        ├── 카카오맵 초기화 - SDK 로드 및 지도 생성
        ├── CCTV 마커 - 파란색 마커 표시, 클릭 시 영상 플레이어
        ├── 이벤트 마커 - 빨간색 마커 표시 (Socket.IO 실시간)
        ├── CCTV 검색 - 자동완성 검색 (debounce)
        └── Camera - HLS 영상 재생, 확대/전체화면/즐겨찾기
```

```
┌─────────────────────────────────────────────────────────────┐
│                    카카오맵 페이지                            │
├─────────────────────────────────────────────────────────────┤
│                                                              │
│  ┌──────────────────────────────────────────────────────┐  │
│  │  카카오맵 영역                                         │  │
│  │  ┌────────────────────────────────────────────────┐   │  │
│  │  │                                                │   │  │
│  │  │            카카오맵 (지도)                      │   │  │
│  │  │                                                │   │  │
│  │  │  📍 CCTV 마커 (파란색)                         │   │  │
│  │  │  ⚠️  이벤트 마커 (빨간색)                       │   │  │
│  │  │                                                │   │  │
│  │  └────────────────────────────────────────────────┘   │  │
│  │                                                        │  │
│  │  ┌────────────────────────────────────────────────┐   │  │
│  │  │  CCTV 검색 영역                                  │   │  │
│  │  │  ┌──────────────────────────────────────────┐   │   │  │
│  │  │  │ [검색 입력창]                              │   │   │  │
│  │  │  │  └─ 자동완성 목록 표시                     │   │   │  │
│  │  │  └──────────────────────────────────────────┘   │   │  │
│  │  └────────────────────────────────────────────────┘   │  │
│  │                                                        │  │
│  │  ┌────────────────────────────────────────────────┐   │  │
│  │  │  CCTV 영상 플레이어 영역                        │   │  │
│  │  │  ┌──────────────────────────────────────────┐   │   │  │
│  │  │  │  CCTV 위치: [위치명]                      │   │   │  │
│  │  │  │  [🔍 확대] [⛶ 전체화면] [★ 즐겨찾기]      │   │   │  │
│  │  │  │  ┌────────────────────────────────────┐   │   │   │  │
│  │  │  │  │                                    │   │   │   │  │
│  │  │  │  │      HLS 영상 스트림 재생           │   │   │   │  │
│  │  │  │  │                                    │   │   │   │  │
│  │  │  │  └────────────────────────────────────┘   │   │   │  │
│  │  │  └──────────────────────────────────────────┘   │   │  │
│  │  └────────────────────────────────────────────────┘   │  │
│  └──────────────────────────────────────────────────────┘  │
│                                                              │
│  ┌──────────────────────────────────────────────────────┐  │
│  │  대시보드 (우측 사이드바)                              │  │
│  │  ┌──────────────────────────────────────────────┐   │  │
│  │  │ [즐겨찾기]                                     │   │  │
│  │  │ - CCTV 목록 (클릭 시 지도로 이동)              │   │  │
│  │  └──────────────────────────────────────────────┘   │  │
│  │  ┌──────────────────────────────────────────────┐   │  │
│  │  │ [최신 이벤트]                                  │   │  │
│  │  │ - 이벤트 목록 (클릭 시 지도로 이동)            │   │  │
│  │  └──────────────────────────────────────────────┘   │  │
│  └──────────────────────────────────────────────────────┘  │
│                                                              │
└─────────────────────────────────────────────────────────────┘

기능:
  ├─ 카카오맵 표시
  │   └─ 지도 초기화 및 표시
  ├─ CCTV 마커 표시
  │   └─ 모든 CCTV 위치를 파란색 마커로 표시
  ├─ 이벤트 마커 표시
  │   └─ 실시간 이벤트를 빨간색 마커로 표시 (Socket.IO)
  ├─ CCTV 검색 기능
  │   ├─ 검색어 입력
  │   ├─ 자동완성 목록 표시
  │   └─ CCTV 선택 시 지도로 이동
  ├─ CCTV 클릭 기능
  │   └─ 마커 클릭 시 영상 플레이어 표시
  ├─ 영상 플레이어
  │   ├─ HLS 스트림 재생
  │   ├─ 확대 기능
  │   ├─ 전체화면 기능
  │   └─ 즐겨찾기 추가/제거
  ├─ 즐겨찾기 대시보드
  │   └─ CCTV 목록 표시 및 클릭 시 지도로 이동
  └─ 최신 이벤트 대시보드
      └─ 실시간 이벤트 목록 표시 및 클릭 시 지도로 이동
```

### 3. CCTV 페이지 (/favorite)

```
Palantir
└── FavoritePage
    ├── FavoritePageProvider - 페이지 상태 관리
    ├── Dashboard - 즐겨찾기, 최신 이벤트 목록 표시
    └── FavoritePageContent
        ├── CCTV 그리드 (2x2, 최대 4개) - Camera 컴포넌트, 배치 모드, 빈 슬롯
        │   └── Camera - HLS 영상 재생, 확대/전체화면/즐겨찾기/분석 버튼
        ├── 분석 모드 - 컴팩트 그리드 + 분석 그래프 영역 (추후 구현)
        ├── 확대 기능 - 전체 화면 확대, 애니메이션, URL 쿼리 제어
        ├── 즐겨찾기 관리 - 추가/해제, 확인 모달
        └── 대기 중 CCTV 알림 - pendingCCTV 상태 표시
```

```
┌─────────────────────────────────────────────────────────────┐
│                    CCTV 페이지                              │
├─────────────────────────────────────────────────────────────┤
│                                                              │
│  ┌──────────────────────────────────────────────────────┐  │
│  │  CCTV 그리드 영역 (2x2, 최대 4개)                    │  │
│  │                                                       │  │
│  │  ┌──────────────────┐  ┌──────────────────┐       │  │
│  │  │ 📹 CCTV 1        │  │ 📹 CCTV 2        │       │  │
│  │  │ [위치명]          │  │ [위치명]          │       │  │
│  │  │ [🔍] [⛶] [★] [분석]│  │ [🔍] [⛶] [★] [분석]│       │  │
│  │  │ ┌──────────────┐ │  │ ┌──────────────┐ │       │  │
│  │  │ │              │ │  │ │              │ │       │  │
│  │  │ │  영상 스트림  │ │  │ │  영상 스트림  │ │       │  │
│  │  │ │              │ │  │ │              │ │       │  │
│  │  │ └──────────────┘ │  │ └──────────────┘ │       │  │
│  │  └──────────────────┘  └──────────────────┘       │  │
│  │                                                       │  │
│  │  ┌──────────────────┐  ┌──────────────────┐       │  │
│  │  │ 📹 CCTV 3        │  │ 📹 CCTV 4        │       │  │
│  │  │ [위치명]          │  │ [위치명]          │       │  │
│  │  │ [🔍] [⛶] [★] [분석]│  │ [🔍] [⛶] [★] [분석]│       │  │
│  │  │ ┌──────────────┐ │  │ ┌──────────────┐ │       │  │
│  │  │ │              │ │  │ │              │ │       │  │
│  │  │ │  영상 스트림  │ │  │ │  영상 스트림  │ │       │  │
│  │  │ │              │ │  │ │              │ │       │  │
│  │  │ └──────────────┘ │  │ └──────────────┘ │       │  │
│  │  └──────────────────┘  └──────────────────┘       │  │
│  └──────────────────────────────────────────────────────┘  │
│                                                              │
│  ┌──────────────────────────────────────────────────────┐  │
│  │  분석 모드 영역 (분석 모드 활성화 시)                  │  │
│  │  ┌──────────────────────────────────────────────┐   │  │
│  │  │  상단: CCTV 그리드 (컴팩트 모드, 1x4)         │   │  │
│  │  └──────────────────────────────────────────────┘   │  │
│  │  ┌──────────────────────────────────────────────┐   │  │
│  │  │  하단: 분석 그래프 영역 (추후 구현 예정)        │   │  │
│  │  └──────────────────────────────────────────────┘   │  │
│  └──────────────────────────────────────────────────────┘  │
│                                                              │
│  ┌──────────────────────────────────────────────────────┐  │
│  │  대시보드 (우측 사이드바)                              │  │
│  │  ┌──────────────────────────────────────────────┐   │  │
│  │  │ [즐겨찾기]                                     │   │  │
│  │  │ - CCTV 목록 (클릭 시 그리드에 배치)             │   │  │
│  │  └──────────────────────────────────────────────┘   │  │
│  │  ┌──────────────────────────────────────────────┐   │  │
│  │  │ [최신 이벤트]                                  │   │  │
│  │  │ - 이벤트 목록                                  │   │  │
│  │  └──────────────────────────────────────────────┘   │  │
│  └──────────────────────────────────────────────────────┘  │
│                                                              │
└─────────────────────────────────────────────────────────────┘

기능:
  ├─ CCTV 그리드 표시
  │   └─ 즐겨찾기 CCTV를 2x2 그리드로 표시 (최대 4개)
  ├─ CCTV 영상 재생
  │   └─ 각 CCTV의 HLS 스트림을 동시에 재생
  ├─ CCTV 확대 기능
  │   └─ CCTV 클릭 시 전체 화면으로 확대
  ├─ 분석 모드
  │   ├─ 분석 버튼 클릭 시 분석 모드 활성화
  │   ├─ 상단에 CCTV 그리드 (컴팩트 모드)
  │   └─ 하단에 분석 그래프 영역 (추후 구현)
  ├─ 즐겨찾기 관리
  │   ├─ 즐겨찾기 추가/제거
  │   └─ 확인 모달 표시
  ├─ CCTV 배치 기능
  │   └─ 대시보드에서 CCTV 선택 시 그리드에 배치
  └─ 대시보드 연동
      ├─ 즐겨찾기 목록 표시
      └─ 최신 이벤트 목록 표시
```

### 4. 홈 페이지 (/home)

```
Palantir
└── Home
    └── 기본 텍스트 - "CCTV 지도" 표시
```

```
┌─────────────────────────────────────────────────────────────┐
│                    홈 페이지                                │
├─────────────────────────────────────────────────────────────┤
│                                                              │
│  ┌──────────────────────────────────────────────────────┐  │
│  │  기본 텍스트 영역                                     │  │
│  │  "CCTV 지도"                                         │  │
│  └──────────────────────────────────────────────────────┘  │
│                                                              │
└─────────────────────────────────────────────────────────────┘

기능:
  └─ 기본 텍스트 표시
```

### 5. 로그인 페이지 (/auth/login)

```
Palantir
└── LoginForm
    ├── 탭 전환 - 로그인/회원가입 탭
    ├── 로그인 폼 - 아이디/이메일, 비밀번호 입력, 로그인 API 호출
    └── 회원가입 폼 - 사용자명, 이메일(검증), 비밀번호 입력, 회원가입 API 호출
```

### 6. 공통 레이아웃 컴포넌트 (모든 페이지에서 사용)

```
Palantir
└── MainPage
    ├── LayoutProvider - 레이아웃 상태 관리
    ├── Header
    │   ├── 로고 - Palantir 로고 및 홈 이동
    │   ├── 네비게이션 메뉴 - 대시보드/지도/CCTV 링크
    │   └── 우측 메뉴 - 알림, 다크모드 토글, 프로필 드롭다운
    └── Sidebar
        ├── 네비게이션 메뉴 - 대시보드/지도/CCTV (아이콘+라벨)
        ├── 설정 메뉴 - 설정 페이지 이동
        └── 축소/확장 버튼 - 사이드바 토글
```

```
┌─────────────────────────────────────────────────────────────┐
│                    로그인 페이지                            │
├─────────────────────────────────────────────────────────────┤
│                                                              │
│  ┌──────────────────────────────────────────────────────┐  │
│  │  로그인 탭                                            │  │
│  │  ┌──────────────────────────────────────────────┐   │  │
│  │  │ 아이디/이메일: [입력창]                       │   │  │
│  │  │ 비밀번호:     [입력창]                       │   │  │
│  │  │ [로그인 버튼]                                 │   │  │
│  │  └──────────────────────────────────────────────┘   │  │
│  └──────────────────────────────────────────────────────┘  │
│                                                              │
│  ┌──────────────────────────────────────────────────────┐  │
│  │  회원가입 탭                                          │  │
│  │  ┌──────────────────────────────────────────────┐   │  │
│  │  │ 사용자명:     [입력창]                       │   │  │
│  │  │ 이메일:       [입력창]                       │   │  │
│  │  │ 비밀번호:     [입력창]                       │   │  │
│  │  │ [회원가입 버튼]                               │   │  │
│  │  └──────────────────────────────────────────────┘   │  │
│  └──────────────────────────────────────────────────────┘  │
│                                                              │
└─────────────────────────────────────────────────────────────┘

기능:
  ├─ 로그인 기능
  │   ├─ 아이디/이메일 입력
  │   ├─ 비밀번호 입력
  │   └─ 로그인 API 호출 → JWT 토큰 발급 → 홈으로 이동
  └─ 회원가입 기능
      ├─ 사용자명 입력
      ├─ 이메일 입력 및 검증
      ├─ 비밀번호 입력
      └─ 회원가입 API 호출 → 계정 생성 → 로그인 페이지로 이동
```

---

## 메뉴 구성 화면 (탑 다운 방식)

### 전체 메뉴 구조

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                              Palantir 애플리케이션                            │
└─────────────────────────────────────────────────────────────────────────────┘
                                    │
                                    ▼
                    ┌───────────────────────────────┐
                    │      인증 상태 확인            │
                    └───────────────┬───────────────┘
                                    │
                    ┌───────────────┴───────────────┐
                    │                               │
                    ▼                               ▼
        ┌───────────────────────┐      ┌───────────────────────┐
        │   비로그인 상태         │      │    로그인 상태          │
        └───────────┬───────────┘      └───────────┬───────────┘
                    │                               │
                    ▼                               ▼
        ┌───────────────────────┐      ┌───────────────────────┐
        │   로그인 페이지        │      │   메인 레이아웃        │
        │   (/auth/login)        │      │   (MainPage)          │
        └───────────────────────┘      └───────────┬───────────┘
                                                    │
                                    ┌───────────────┼───────────────┐
                                    │               │               │
                                    ▼               ▼               ▼
                        ┌───────────────┐  ┌───────────────┐  ┌───────────────┐
                        │    Header     │  │    Sidebar    │  │  Main Content │
                        │   (상단 바)    │  │  (사이드바)   │  │   (메인 영역)  │
                        └───────┬───────┘  └───────┬───────┘  └───────┬───────┘
                                │                  │                  │
                                │                  │                  │
                    ┌───────────┼───────────┐     │                  │
                    │           │           │     │                  │
                    ▼           ▼           ▼     ▼                  │
            ┌───────────┐ ┌───────────┐ ┌───────────┐ ┌───────────┐
            │  로고      │ │ 네비게이션 │ │  알림/다크 │ │ 프로필 메뉴│
            │ (Palantir)│ │   메뉴     │ │   모드     │ │           │
            └───────────┘ └─────┬─────┘ └───────────┘ └─────┬───────┘
                                │                           │
                    ┌───────────┼───────────┐              │
                    │           │           │              │
                    ▼           ▼           ▼              ▼
            ┌───────────┐ ┌───────────┐ ┌───────────┐ ┌───────────┐
            │ 대시보드   │ │   지도     │ │   CCTV    │ │ 계정관리   │
            │(/dashboard)│ │(/kakao-map)│ │(/favorite)│ │  로그아웃  │
            └───────────┘ └───────────┘ └───────────┘ └───────────┘
                                │
                    ┌───────────┼───────────┐
                    │           │           │
                    ▼           ▼           ▼
            ┌───────────┐ ┌───────────┐ ┌───────────┐
            │ 대시보드   │ │   지도     │ │   CCTV    │
            │(/dashboard)│ │(/kakao-map)│ │(/favorite)│
            └───────────┘ └───────────┘ └───────────┘
                                │
                                ▼
                        ┌───────────────┐
                        │    설정       │
                        │  (/settings)  │
                        └───────────────┘
```

### Header 메뉴 구조 (상세)

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                                  Header                                      │
├──────────────────┬──────────────────────────────┬──────────────────────────┤
│                  │                              │                          │
│   좌측 영역       │        중앙 영역              │       우측 영역           │
│                  │                              │                          │
│  ┌────────────┐  │  ┌────────────────────────┐  │  ┌────────────────────┐  │
│  │  Palantir  │  │  │   네비게이션 메뉴       │  │  │  알림 │ 다크모드 │  │
│  │   로고      │  │  │                        │  │  │  버튼 │  토글    │  │
│  │  (링크)     │  │  │  ┌────┐ ┌────┐ ┌────┐ │  │  └────────┬───────────┘  │
│  └────────────┘  │  │  │대시│ │지도│ │CCTV│ │  │           │              │
│                  │  │  │보드│ │    │ │    │ │  │           ▼              │
│                  │  │  └────┘ └────┘ └────┘ │  │  ┌────────────────────┐  │
│                  │  │                        │  │  │   프로필 메뉴        │  │
│                  │  │  /dashboard            │  │  │  ┌────────────────┐  │  │
│                  │  │  /kakao-map           │  │  │  │ 사용자명        │  │  │
│                  │  │  /favorite            │  │  │  ├────────────────┤  │  │
│                  │  └────────────────────────┘  │  │  │ 계정관리        │  │  │
│                  │                              │  │  ├────────────────┤  │  │
│                  │                              │  │  │ 로그아웃        │  │  │
│                  │                              │  │  └────────────────┘  │  │
│                  │                              │  └────────────────────┘  │
└──────────────────┴──────────────────────────────┴──────────────────────────┘
```

### Sidebar 메뉴 구조 (상세)

```
┌─────────────────────────────────────┐
│            Sidebar                  │
├─────────────────────────────────────┤
│                                     │
│  ┌───────────────────────────────┐  │
│  │   네비게이션 메뉴 영역          │  │
│  │                               │  │
│  │  ┌─────────────────────────┐  │  │
│  │  │ 📊 대시보드              │  │  │
│  │  │    (/dashboard)          │  │  │
│  │  └─────────────────────────┘  │  │
│  │                               │  │
│  │  ┌─────────────────────────┐  │  │
│  │  │ 🗺️  지도                  │  │  │
│  │  │    (/kakao-map)          │  │  │
│  │  └─────────────────────────┘  │  │
│  │                               │  │
│  │  ┌─────────────────────────┐  │  │
│  │  │ 📹 CCTV                  │  │  │
│  │  │    (/favorite)           │  │  │
│  │  └─────────────────────────┘  │  │
│  │                               │  │
│  └───────────────────────────────┘  │
│                                     │
│  ─────────────────────────────────  │
│                                     │
│  ┌───────────────────────────────┐  │
│  │   설정 영역                    │  │
│  │                               │  │
│  │  ┌─────────────────────────┐  │  │
│  │  │ ⚙️  설정                  │  │  │
│  │  │    (/settings)           │  │  │
│  │  └─────────────────────────┘  │  │
│  │                               │  │
│  └───────────────────────────────┘  │
│                                     │
│  [◄] 사이드바 축소/확장 버튼         │
│                                     │
└─────────────────────────────────────┘
```

### 프로필 메뉴 구조 (드롭다운)

```
                    ┌─────────────────────┐
                    │   프로필 버튼        │
                    │   (사용자명)         │
                    └──────────┬──────────┘
                               │
                               ▼
                    ┌─────────────────────┐
                    │   드롭다운 메뉴      │
                    ├─────────────────────┤
                    │  사용자명 (헤더)     │
                    ├─────────────────────┤
                    │  계정관리           │
                    │  (/settings)        │
                    ├─────────────────────┤
                    │  로그아웃           │
                    │  (logout 함수)      │
                    └─────────────────────┘
```

### 메뉴 항목 상세 정보

#### 1. 대시보드 메뉴
- **경로**: `/dashboard`
- **라벨**: "대시보드"
- **아이콘**: `/icons/dashboard.svg`
- **위치**: Header 중앙, Sidebar 상단
- **설명**: CCTV 분석 데이터를 차트로 시각화하여 표시

#### 2. 지도 메뉴
- **경로**: `/kakao-map`
- **라벨**: "지도"
- **아이콘**: `/icons/map.svg`
- **위치**: Header 중앙, Sidebar 중간
- **설명**: 카카오맵에 CCTV 위치와 이벤트를 마커로 표시

#### 3. CCTV 메뉴
- **경로**: `/favorite`
- **라벨**: "CCTV"
- **아이콘**: `/icons/cctv.svg`
- **위치**: Header 중앙, Sidebar 하단
- **설명**: 즐겨찾기 CCTV 영상을 그리드 형태로 동시 재생

#### 4. 설정 메뉴
- **경로**: `/settings`
- **라벨**: "설정"
- **아이콘**: ⚙️
- **위치**: Sidebar 하단
- **설명**: 사용자 계정 설정 및 애플리케이션 설정

#### 5. 프로필 메뉴 (드롭다운)
- **계정관리**: `/settings`로 이동
- **로그아웃**: 로그아웃 처리 후 `/auth/login`으로 이동
- **위치**: Header 우측 상단

### 메뉴 접근 제어

```
                    ┌─────────────────────┐
                    │   페이지 접근 시도    │
                    └──────────┬───────────┘
                               │
                               ▼
                    ┌─────────────────────┐
                    │  로그인 상태 확인     │
                    └──────────┬───────────┘
                               │
                ┌───────────────┴───────────────┐
                │                               │
                ▼                               ▼
    ┌───────────────────────┐      ┌───────────────────────┐
    │   로그인 안 됨          │      │   로그인 됨            │
    └───────────┬───────────┘      └───────────┬───────────┘
                │                               │
                ▼                               ▼
    ┌───────────────────────┐      ┌───────────────────────┐
    │  /auth/login으로      │      │  요청한 페이지로        │
    │  리다이렉트            │      │  접근 허용              │
    └───────────────────────┘      └───────────────────────┘
```

### 반응형 메뉴 구조

```
┌─────────────────────────────────────────────────────────────┐
│                    데스크톱 (lg 이상)                          │
├─────────────────────────────────────────────────────────────┤
│  Header: 로고 + 네비게이션 메뉴 (중앙) + 우측 메뉴           │
│  Sidebar: 항상 표시 (축소/확장 가능)                          │
└─────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────┐
│                    모바일/태블릿 (lg 미만)                     │
├─────────────────────────────────────────────────────────────┤
│  Header: 로고 + 햄버거 메뉴 (네비게이션 숨김) + 우측 메뉴    │
│  Sidebar: 기본 숨김 (햄버거 메뉴로 토글)                      │
└─────────────────────────────────────────────────────────────┘
```

---

## 플로우 차트

> **플로우 차트 기호 설명 (표준 ANSI/ISO 기호)**
> - ╭─╮ (타원형/Ellipse): 시작/종료 (Start/End)
> - ┌─┐ (사각형/Rectangle): 프로세스/처리 (Process)
> - ╱─╲ (평행사변형/Parallelogram): 입력/출력 (Input/Output)
> - ◇ (마름모/Diamond): 판단/조건 (Decision)
> - → (화살표/Arrow): 흐름 방향 (Flow Direction)

### 1. 전체 시스템 플로우

```
                    ╭─────────────╮
                    │    시작      │
                    ╰──────┬──────╯
                           │
                           ▼
                    ┌─────────────┐
                    │ 로그인 페이지 │
                    │  (/auth/login)│
                    └──────┬──────┘
                           │
                    ┌──────┴──────┐
                    │             │
              [로그인]      [회원가입]
                    │             │
                    ▼             ▼
            ┌──────────┐   ┌──────────┐
            │ 로그인 성공│   │ 회원가입 성공│
            └─────┬────┘   └─────┬────┘
                  │              │
                  └──────┬───────┘
                         │
                         ▼
                  ┌─────────────┐
                  │  홈 페이지   │
                  │   (/home)    │
                  └──────┬───────┘
                         │
        ┌────────────────┼────────────────┐
        │                │                │
        ▼                ▼                ▼
┌─────────────┐  ┌─────────────┐  ┌─────────────┐
│ 대시보드 페이지│  │  지도 페이지  │  │ CCTV 페이지  │
│ (/dashboard) │  │ (/kakao-map) │  │ (/favorite) │
└─────────────┘  └─────────────┘  └─────────────┘
```

### 2. 대시보드 페이지 플로우

```
╭─────────────────────╮
│ 대시보드 페이지 진입  │
╰──────────┬──────────╯
           │
           ▼
┌─────────────────────┐
│ 즐겨찾기 CCTV 목록 로드│
└──────────┬──────────┘
           │
           ▼
╱─────────────────────╲
│ CCTV 선택            │
╲──────────┬──────────╱
           │
           ▼
┌─────────────────────┐
│ 분석 완료 시간대 조회  │
└──────────┬──────────┘
           │
           ▼
╱─────────────────────╲
│ 시간대 선택          │
╲──────────┬──────────╱
           │
           ▼
    ┌─────────────┐
    │ 데이터 조회   │
    │ (병렬 처리)   │
    └──────┬──────┘
           │
    ┌──────┴──────┐
    │             │
    ▼             ▼
┌─────────┐  ┌─────────┐
│ 혼잡도   │  │ 차량 통계│
│ 데이터   │  │ 데이터   │
└────┬────┘  └────┬────┘
     │           │
     └─────┬─────┘
           │
           ▼
    ┌─────────────┐
    │ 객체 유형    │
    │ 통계 데이터  │
    └──────┬──────┘
           │
           ▼
┌─────────────────────┐
│ 차트 렌더링          │
│ - 혼잡도 차트        │
│ - 차량 수 차트       │
│ - 객체 유형 차트      │
└──────────┬──────────┘
           │
           ▼
    ╭─────────────╮
    │    종료      │
    ╰─────────────╯
```

### 3. 지도 페이지 플로우

```
╭─────────────────────╮
│ 지도 페이지 진입     │
╰──────────┬──────────╯
           │
           ▼
┌─────────────────────┐
│ 카카오맵 SDK 로드     │
└──────────┬──────────┘
           │
           ▼
┌─────────────────────┐
│ 지도 초기화          │
└──────────┬──────────┘
           │
           ▼
┌─────────────────────┐
│ CCTV 위치 데이터 로드 │
└──────────┬──────────┘
           │
           ▼
┌─────────────────────┐
│ CCTV 마커 표시       │
└──────────┬──────────┘
           │
           ▼
┌─────────────────────┐
│ 이벤트 데이터 로드    │
│ (Socket.IO)         │
└──────────┬──────────┘
           │
           ▼
┌─────────────────────┐
│ 이벤트 마커 표시      │
└──────────┬──────────┘
           │
           ▼
    ╱─────────────╲
    │ 사용자 액션   │
    ╲──────┬──────╱
           │
    ┌──────┴──────┐
    │             │
    ▼             ▼
┌─────────┐  ┌─────────┐
│ CCTV    │  │ 검색    │
│ 클릭    │  │ 입력    │
└────┬────┘  └────┬────┘
     │           │
     │           ▼
     │      ┌─────────┐
     │      │ 자동완성 │
     │      └────┬────┘
     │           │
     │           ▼
     │      ╱─────────╲
     │      │ CCTV 선택│
     │      ╲────┬────╱
     │           │
     └───────┬───┘
             │
             ▼
    ┌─────────────────┐
    │ 스트림 URL 조회   │
    └────────┬─────────┘
             │
             ▼
    ┌─────────────────┐
    │ 영상 플레이어 표시│
    └────────┬─────────┘
             │
             ▼
    ┌─────────────────┐
    │ HLS 스트림 재생   │
    └────────┬─────────┘
             │
             ▼
    ╭─────────────────╮
    │      종료        │
    ╰─────────────────╯
```

### 4. CCTV 페이지 플로우

```
╭─────────────────────╮
│ CCTV 페이지 진입     │
╰──────────┬──────────╯
           │
           ▼
┌─────────────────────┐
│ 즐겨찾기 CCTV 로드    │
└──────────┬──────────┘
           │
           ▼
┌─────────────────────┐
│ CCTV 그리드 표시     │
│ (최대 4개)          │
└──────────┬──────────┘
           │
           ▼
┌─────────────────────┐
│ 각 CCTV 영상 스트림  │
│ 동시 재생            │
└──────────┬──────────┘
           │
           ▼
    ╱─────────────╲
    │ 사용자 액션   │
    ╲──────┬──────╱
           │
    ┌──────┴──────┐
    │             │
    ▼             ▼
┌─────────┐  ┌─────────┐
│ CCTV    │  │ 분석    │
│ 확대    │  │ 모드    │
└────┬────┘  └────┬────┘
     │           │
     │           ▼
     │      ╱─────────╲
     │      │ CCTV 선택│
     │      ╲────┬────╱
     │           │
     │           ▼
     │      ┌─────────┐
     │      │ 분석 시작│
     │      └────┬────┘
     │           │
     │           ▼
     │      ┌─────────┐
     │      │ 분석 완료│
     │      │ (백그라운드)│
     │      └────┬────┘
     │           │
     │           ▼
     │      ┌─────────┐
     │      │ 대시보드 │
     │      │ 결과 확인│
     │      └─────────┘
     │
     ▼
┌─────────────┐
│ 확대된 영상  │
│ 표시        │
└──────┬──────┘
       │
       ▼
╭─────────────╮
│     종료     │
╰─────────────╯
```

### 5. 인증 플로우

```
╭─────────────────────╮
│ 로그인 페이지 접근    │
╰──────────┬──────────╯
           │
           ▼
┌─────────────────────┐
│ 로그인 상태 확인     │
└──────────┬──────────┘
           │
    ┌──────┴──────┐
    │             │
    ▼             ▼
╱─────────╲  ╱─────────╲
│ 로그인   │  │ 회원가입 │
│ 탭      │  │ 탭      │
╲────┬────╱  ╲────┬────╱
     │           │
     │           ▼
     │      ╱─────────╲
     │      │ 정보 입력│
     │      │ - 사용자명│
     │      │ - 이메일 │
     │      │ - 비밀번호│
     │      ╲────┬────╱
     │           │
     │           ▼
     │      ┌─────────┐
     │      │ 이메일   │
     │      │ 검증    │
     │      └────┬────┘
     │           │
     │           ▼
     │      ┌─────────┐
     │      │ 회원가입 │
     │      │ API 호출│
     │      └────┬────┘
     │           │
     │           ▼
     │      ┌─────────┐
     │      │ 계정 생성│
     │      └────┬────┘
     │           │
     │           │
     │           │
     ▼           │
╱─────────╲      │
│ 정보 입력│      │
│ - 아이디/│      │
│   이메일 │      │
│ - 비밀번호│     │
╲────┬────╱      │
     │           │
     ▼           │
┌─────────┐      │
│ 로그인   │      │
│ API 호출│      │
└────┬────┘      │
     │           │
     └───────┬───┘
             │
             ▼
    ┌─────────────────┐
    │ JWT 토큰 발급     │
    └────────┬─────────┘
             │
             ▼
    ┌─────────────────┐
    │ 로컬 스토리지 저장│
    └────────┬─────────┘
             │
             ▼
    ┌─────────────────┐
    │ 홈 페이지로 이동  │
    └────────┬─────────┘
             │
             ▼
    ╭─────────────────╮
    │      종료        │
    ╰─────────────────╯
```

### 6. 영상 재생 플로우

```
╭─────────────────────╮
│ CCTV 선택 (마커/목록) │
╰──────────┬──────────╯
           │
           ▼
┌─────────────────────┐
│ 스트림 URL 요청      │
└──────────┬──────────┘
           │
           ▼
┌─────────────────────┐
│ 캐시 확인            │
└──────────┬──────────┘
           │
           ▼
    ┌─────────────┐
    │ 캐시 있음?   │
    └──────┬──────┘
           │
    ┌──────┴──────┐
    │             │
    ▼             ▼
┌─────────┐  ┌─────────┐
│ 캐시     │  │ API 호출│
│ 사용     │  │         │
└────┬────┘  └────┬────┘
     │           │
     │           ▼
     │      ┌─────────┐
     │      │ URL 획득│
     │      └────┬────┘
     │           │
     │           ▼
     │      ┌─────────┐
     │      │ 캐시 저장│
     │      └────┬────┘
     │           │
     └───────┬───┘
             │
             ▼
    ┌─────────────────┐
    │ HLS.js 초기화    │
    └────────┬─────────┘
             │
             ▼
    ┌─────────────────┐
    │ 스트림 로드      │
    └────────┬─────────┘
             │
             ▼
    ┌─────────────────┐
    │ 영상 재생 시작    │
    └────────┬─────────┘
             │
             ▼
    ┌─────────────────┐
    │ 재생 상태 모니터링│
    └────────┬─────────┘
             │
             ▼
        ╱─────────╲
        │ 재생 상태 │
        ╲────┬────╱
             │
    ┌────────┴────────┐
    │                 │
    ▼                 ▼
┌─────────┐      ┌─────────┐
│ 정상     │      │ 멈춤     │
│ 재생     │      │ 감지     │
└────┬────┘      └────┬────┘
     │                │
     │                ▼
     │         ┌─────────────┐
     │         │ 10초 타이머  │
     │         │ 시작        │
     │         └──────┬──────┘
     │                │
     │                ▼
     │            ╱─────────╲
     │            │ 여전히   │
     │            │ 멈춤?    │
     │            ╲────┬────╱
     │                 │
     │         ┌───────┴───────┐
     │         │               │
     │         ▼               ▼
     │    ┌─────────┐    ┌─────────┐
     │    │ 재생 재개│    │ 자동 재시도│
     │    │ (타이머  │    │ (최대 3회) │
     │    │ 취소)    │    │           │
     │    └────┬────┘    └────┬──────┘
     │         │              │
     │         └──────┬───────┘
     │                │
     └────────────────┘
             │
             ▼
    ╭─────────────────╮
    │      종료        │
    ╰─────────────────╯
```

---

## 화면별 상세 구조

### 1. MainPage (레이아웃 페이지)
**경로**: `/`
**역할**: 공통 레이아웃 제공

```
MainPage
├── LayoutProvider
└── div (전체 컨테이너)
    ├── Header (상단 헤더)
    │   ├── 로고 (Palantir)
    │   ├── 네비게이션 메뉴
    │   │   ├── 대시보드
    │   │   ├── 지도
    │   │   └── CCTV
    │   └── 우측 메뉴
    │       ├── NotificationBell (알림)
    │       ├── 다크모드 토글
    │       └── 사용자 메뉴
    ├── Sidebar (좌측 사이드바)
    │   ├── 네비게이션 메뉴
    │   └── 설정 버튼
    └── main (콘텐츠 영역)
        └── <Outlet /> (하위 페이지 렌더링)
```

### 2. Home Page
**페이지 이름**: 홈 페이지
**유스케이스 ID**: UC-001
**경로**: `/home`
**메뉴 경로**: 홈 > 홈 페이지
**화면 개요**: 사용자가 로그인 후 처음 접하는 메인 화면으로, 시스템의 기본 안내를 제공합니다.
**페이지 설명**: 현재는 간단한 환영 메시지를 표시하는 기본 홈 화면입니다. 향후 주요 기능 요약, 최근 활동, 빠른 접근 링크 등을 추가할 수 있는 확장 가능한 구조로 설계되었습니다.

```
Home
└── div
    └── h1 "CCTV 지도"
```

### 3. DashBoardPage (대시보드)
**페이지 이름**: 대시보드 페이지
**유스케이스 ID**: UC-002
**경로**: `/dashboard`
**메뉴 경로**: 헤더 > 대시보드 / 사이드바 > 대시보드
**화면 개요**: CCTV 분석 데이터를 차트 형태로 시각화하여 제공하는 통계 분석 화면입니다. 사용자는 즐겨찾기 CCTV를 선택하고, 분석 완료된 시간대를 선택하여 해당 시간대의 혼잡도, 차량 통계, 객체 유형 통계를 확인할 수 있습니다.
**페이지 설명**: 대시보드 페이지는 딥러닝 분석을 통해 수집된 CCTV 데이터를 사용자 친화적인 차트로 시각화합니다. 상단 헤더에서 CCTV와 시간대를 선택하면, 하단에 3개의 차트가 표시됩니다. 혼잡도 차트는 선 그래프로 시간대별 혼잡도 변화를 보여주고, 차량 수 차트는 막대 그래프로 시간대별 차량 통계를, 객체 유형 차트는 도넛 차트로 감지된 객체 유형의 비율을 표시합니다. 각 차트는 독립적으로 로딩 및 에러 상태를 관리하며, 실패 시 재시도 기능을 제공합니다.

```
DashBoardPage
└── div (전체 컨테이너)
    ├── DashboardHeader
    │   ├── CCTV 선택 드롭다운
    │   ├── 시간대 선택 드롭다운
    │   └── 보고서 출력 버튼
    ├── 에러 메시지 영역
    ├── 빈 상태 메시지
    └── 차트 영역 (선택된 CCTV와 시간대가 있을 때)
        ├── CongestionChart (혼잡도 차트 - 큰 차트)
        └── 하단 작은 차트 2개
            ├── VehicleCountChart (차량 수 차트)
            └── ObjectTypeChart (객체 유형 차트)
```

**주요 기능**:
- 즐겨찾기 CCTV 목록에서 선택
- 분석 완료된 시간대 목록 조회
- 선택한 시간대의 통계 데이터 시각화
- 개별 차트별 로딩/에러 상태 관리
- 재시도 기능

### 4. KakaoMapPage (지도 페이지)
**페이지 이름**: 지도 페이지
**유스케이스 ID**: UC-003
**경로**: `/kakao-map`
**메뉴 경로**: 헤더 > 지도 / 사이드바 > 지도
**화면 개요**: 카카오맵을 통해 CCTV 위치를 지도상에 마커로 표시하고, CCTV를 클릭하면 해당 위치의 실시간 영상을 재생할 수 있는 지도 기반 모니터링 화면입니다. 우측 대시보드에서는 즐겨찾기 CCTV 목록과 최신 이벤트를 확인할 수 있습니다.
**페이지 설명**: 지도 페이지는 카카오맵 API를 활용하여 전국 CCTV 위치를 지도상에 시각화합니다. 사용자는 지도에서 CCTV 마커를 클릭하여 해당 위치의 실시간 영상을 하단 플레이어에서 확인할 수 있습니다. 상단 검색 바를 통해 CCTV 위치를 검색할 수 있으며, 자동완성 기능을 제공합니다. CCTV 마커 클릭 시 InfoWindow가 표시되어 CCTV 정보를 확인하고, 즐겨찾기 추가/제거가 가능합니다. 또한 실시간으로 발생하는 교통 이벤트(사고, 공사 등)를 이벤트 마커로 표시하여 사용자에게 알립니다. 영상 재생 중 네트워크 문제로 재생이 멈추면 자동으로 감지하여 재시도하는 기능이 포함되어 있습니다.

```
KakaoMapPage
├── MapProvider
├── Dashboard (우측 대시보드)
│   ├── 즐겨찾기 섹션
│   └── 최신 이벤트 섹션
└── KakaoMap (지도 컴포넌트)
    ├── 검색 바 (상단)
    ├── 카카오맵 (중앙)
    │   ├── CCTV 마커
    │   ├── 이벤트 마커
    │   └── InfoWindow (CCTV 정보)
    └── Camera (하단 영상 플레이어)
        ├── 영상 헤더
        │   ├── 위치 정보
        │   ├── 분석 버튼
        │   └── 확대/축소 버튼
        └── 비디오 플레이어
            ├── HLS 스트림 재생
            ├── 로딩 상태
            ├── 에러 메시지
            └── 즐겨찾기 버튼
```

**주요 기능**:
- 카카오맵 SDK 로드 및 초기화
- CCTV 위치 마커 표시
- 이벤트 마커 표시
- CCTV 클릭 시 영상 재생
- 검색 기능 (자동완성)
- 즐겨찾기 토글
- 실시간 이벤트 업데이트 (Socket.IO)
- 재생 멈춤 자동 감지 및 재시도

### 5. FavoritePage (CCTV 관리 페이지)
**페이지 이름**: CCTV 페이지
**유스케이스 ID**: UC-004
**경로**: `/favorite`
**메뉴 경로**: 헤더 > CCTV / 사이드바 > CCTV
**화면 개요**: 사용자가 즐겨찾기로 등록한 CCTV들을 2x2 그리드 형태로 동시에 모니터링할 수 있는 화면입니다. 각 CCTV의 실시간 영상을 확인하고, 분석 모드를 통해 특정 CCTV에 대한 딥러닝 분석을 실행할 수 있습니다.
**페이지 설명**: CCTV 페이지는 사용자가 자주 확인하는 CCTV들을 한 화면에서 동시에 모니터링할 수 있도록 설계되었습니다. 기본적으로 즐겨찾기 CCTV 4개를 2x2 그리드로 표시하며, 각 CCTV는 독립적인 영상 플레이어로 실시간 스트리밍을 제공합니다. 사용자는 CCTV를 클릭하여 확대하여 더 크게 볼 수 있으며, 분석 버튼을 통해 해당 CCTV에 대한 딥러닝 분석을 실행할 수 있습니다. 분석 모드에서는 분석할 CCTV를 선택하고 분석을 시작하면, 분석 완료 후 대시보드 페이지에서 결과를 확인할 수 있습니다. 즐겨찾기 해제 시 확인 모달이 표시되어 실수로 삭제하는 것을 방지합니다.

```
FavoritePage
├── FavoritePageProvider
├── Dashboard (우측 대시보드)
└── FavoritePageContent
    ├── 분석 모드 컨트롤
    ├── CCTV 그리드 (2x2 또는 확장)
    │   └── Camera 컴포넌트 (각 CCTV)
    │       ├── 영상 헤더
    │       ├── 비디오 플레이어
    │       └── 분석 버튼
    └── 확인 모달 (즐겨찾기 해제 시)
```

**주요 기능**:
- 즐겨찾기 CCTV 4개 동시 재생
- CCTV 확대/축소 기능
- 분석 모드 (CCTV 선택 후 분석 실행)
- 즐겨찾기 추가/제거
- CCTV 배치 모드 (드래그 앤 드롭)

### 6. LoginForm (로그인 페이지)
**페이지 이름**: 로그인 페이지
**유스케이스 ID**: UC-005
**경로**: `/auth/login`
**메뉴 경로**: 헤더 > 로그인 버튼 (비로그인 상태)
**화면 개요**: 사용자 인증을 위한 로그인 및 회원가입 화면입니다. 기존 사용자는 로그인하여 시스템에 접근하고, 신규 사용자는 회원가입을 통해 계정을 생성할 수 있습니다.
**페이지 설명**: 로그인 페이지는 시스템 접근을 위한 인증 화면입니다. 로그인 탭에서는 사용자명 또는 이메일과 비밀번호를 입력하여 로그인할 수 있습니다. 회원가입 탭으로 전환하면 사용자명, 이메일, 비밀번호를 입력하여 새 계정을 생성할 수 있으며, 이메일 형식 검증 기능이 포함되어 있습니다. 로그인 성공 시 JWT 토큰이 발급되어 로컬 스토리지에 저장되며, 이후 모든 API 요청에 자동으로 포함됩니다. 로그인된 사용자가 이 페이지에 접근하면 자동으로 홈 페이지로 리다이렉트됩니다.

```
LoginForm
└── form
    ├── 로그인/회원가입 탭 전환
    ├── 입력 필드
    │   ├── 아이디/이메일
    │   ├── 비밀번호
    │   └── (회원가입 시) 사용자명, 이메일
    └── 제출 버튼
```

---

## 컴포넌트 계층 구조

### Layout 컴포넌트

```
Header
├── 로고 링크
├── 네비게이션 메뉴
│   ├── 대시보드 링크
│   ├── 지도 링크
│   └── CCTV 링크
└── 우측 메뉴
    ├── NotificationBell
    ├── 다크모드 토글
    └── 사용자 메뉴 드롭다운

Sidebar
├── 네비게이션 메뉴 (아이콘 + 텍스트)
└── 설정 링크
```

### Dashboard 컴포넌트

```
Dashboard (우측 고정 패널)
├── 즐겨찾기 섹션
│   └── CCTV 목록 (클릭 가능)
└── 최신 이벤트 섹션
    └── 이벤트 카드 목록 (최대 6개)
```

### Camera 컴포넌트

```
Camera
├── 헤더
│   ├── 위치 정보
│   ├── 분석 버튼 (SearchIcon)
│   ├── 확대/축소 버튼
│   └── 닫기 버튼 (팝업 모드)
├── 비디오 컨테이너
│   ├── video element
│   ├── HLS.js 인스턴스
│   ├── 로딩 오버레이
│   ├── 에러 메시지
│   └── 재시도 카운터
└── 즐겨찾기 버튼 (하단 우측)
```

**재생 멈춤 감지 로직**:
- `stalled` 이벤트: 네트워크 버퍼링 감지
- `waiting` 이벤트: 데이터 대기 감지
- 10초 이상 멈춤 시 자동 재시도
- `playing` 이벤트: 재생 재개 시 타이머 리셋

### Dashboard 차트 컴포넌트

```
DashboardHeader
├── CCTV 선택 드롭다운
├── 시간대 선택 드롭다운
└── 보고서 출력 버튼

CongestionChart (Line Chart)
├── ChartContainer
└── Chart.js Line Chart

VehicleCountChart (Bar Chart)
├── ChartContainer
└── Chart.js Bar Chart

ObjectTypeChart (Doughnut Chart)
├── ChartContainer
└── Chart.js Doughnut Chart

ChartContainer (공통 래퍼)
├── 로딩 상태
├── 빈 데이터 상태
└── children (실제 차트)
```

### Notification 컴포넌트

```
NotificationContainer (전역)
├── NotificationToast (토스트 알림)
└── 위치: 화면 우측 상단

NotificationBell (헤더)
├── 알림 아이콘
└── 알림 개수 배지

NotificationDropdown
└── 알림 목록

NotificationCard
└── 개별 알림 카드
```

---

## 라우팅 구조

### 프론트엔드 라우팅

```
/ (MainPage)
├── /home → Home (로그인 필요)
├── /dashboard → DashBoardPage (로그인 필요)
├── /kakao-map → KakaoMapPage (로그인 필요)
└── /favorite → FavoritePage (로그인 필요)

/auth/login → LoginForm (비로그인 상태)
```

**인증 가드**:
- 로그인 필요 페이지는 `isLoggedIn` 체크 후 `/auth/login`으로 리다이렉트
- 로그인 상태에서 `/auth/login` 접근 시 `/home`으로 리다이렉트

### 백엔드 API 라우팅

```
/api
├── /users
│   ├── POST /login (로그인)
│   ├── POST /register (회원가입)
│   └── GET /me (현재 사용자 정보)
├── /cctv
│   ├── GET / (CCTV 목록)
│   ├── GET /:id/stream (스트림 URL 조회)
│   └── GET /search (CCTV 검색)
├── /favorites
│   ├── GET / (즐겨찾기 목록)
│   ├── POST /:cctv_id (즐겨찾기 추가)
│   └── DELETE /:cctv_id (즐겨찾기 제거)
├── /notifications
│   ├── GET / (알림 목록)
│   └── PUT /:id/read (알림 읽음 처리)
├── /congestion
│   └── GET / (혼잡도 데이터)
└── /dashboard
    ├── GET /analyzed-time-ranges/:cctvId (분석 완료 시간대)
    ├── GET /congestion/:cctvId (혼잡도 데이터)
    ├── GET /vehicles/:cctvId (차량 통계)
    └── GET /detections/:cctvId (객체 유형 통계)
```

### Socket.IO 이벤트

```
클라이언트 → 서버:
- join-events (이벤트 룸 입장)
- authenticate (인증)

서버 → 클라이언트:
- event-update (이벤트 업데이트)
- congestion-alert (혼잡도 알림)
- accident-alert (사고 알림)
```

---

## 데이터 흐름

### 1. CCTV 데이터 로드

```
DataProvider
├── useEffect (마운트 시)
│   ├── fetchCCTVLocations()
│   ├── fetchFavorites()
│   └── refreshAll()
└── Socket.IO 구독
    └── 실시간 업데이트
```

### 2. 대시보드 데이터 로드

```
DashBoardPage
├── CCTV 선택
│   └── getAnalyzedTimeRanges()
├── 시간대 선택
│   ├── getCongestionData() (병렬)
│   ├── getVehicleStatistics() (병렬)
│   └── getDetectionStatistics() (병렬)
└── 차트 렌더링
```

### 3. 영상 스트림 로드

```
Camera Component
├── fetchStreamUrl()
│   ├── 캐시 확인
│   ├── API 호출 (/api/cctv/:id/stream)
│   └── 캐시 저장
├── HLS.js 초기화
│   ├── loadSource()
│   └── attachMedia()
└── 재생 멈춤 감지
    ├── stalled/waiting 이벤트
    ├── 10초 타이머
    └── 자동 재시도
```

---

## 주요 Provider 역할

### AuthProvider
- 사용자 인증 상태 관리
- 로그인/로그아웃/회원가입
- JWT 토큰 관리

### DataProvider
- CCTV 위치 데이터
- 즐겨찾기 데이터
- 전역 데이터 새로고침

### NotificationProvider
- 알림 상태 관리
- 토스트 알림 표시
- Socket.IO 알림 수신

### MapProvider
- 카카오맵 컨텍스트
- CCTV 선택 상태
- 이벤트 선택 상태

### FavoritePageProvider
- 즐겨찾기 페이지 상태
- CCTV 배치 모드
- 분석 모드

### LayoutProvider
- 사이드바 접기/펼치기
- 대시보드 접기/펼치기

### ThemeProvider
- 다크모드/라이트모드
- 테마 상태 관리

---

## 주요 기능 요약

### 1. 인증 시스템
- JWT 기반 인증
- 로그인/회원가입
- 자동 로그인 유지

### 2. CCTV 모니터링
- 실시간 영상 스트리밍 (HLS)
- 재생 멈춤 자동 감지 및 재시도
- 즐겨찾기 관리
- 다중 CCTV 동시 모니터링

### 3. 데이터 분석
- 혼잡도 분석
- 차량 통계
- 객체 유형 통계
- 시간대별 분석 데이터

### 4. 실시간 알림
- Socket.IO 기반 실시간 통신
- 혼잡도 알림
- 사고 알림
- 토스트 알림

### 5. 지도 기능
- 카카오맵 통합
- CCTV 위치 마커
- 이벤트 마커
- 검색 기능

---

## 기술 스택

### Frontend
- React 18
- TypeScript
- Vite
- React Router
- Chart.js
- HLS.js
- Tailwind CSS
- Socket.IO Client

### Backend
- Node.js
- Express
- TypeScript
- MySQL
- Socket.IO
- JWT
- HLS.js (서버)

### Infrastructure
- Docker
- Docker Compose
- Nginx (프론트엔드 서빙)
- MySQL (데이터베이스)

---

## 파일 구조 요약

### Frontend 주요 파일
```
frontend/src/
├── pages/
│   ├── MainPage.tsx
│   ├── Home.tsx
│   ├── DashBoardPage.tsx
│   ├── KakaoMapPage.tsx
│   └── FavoritePage.tsx
├── components/
│   ├── Camera/Camera.tsx
│   ├── Dashboard/
│   ├── Layout/
│   ├── Notification/
│   └── KakaoMap.tsx
├── providers/
│   ├── AuthProvider.tsx
│   ├── DataProvider.tsx
│   └── ...
└── services/
    ├── api.ts
    ├── auth.ts
    └── socket.ts
```

### Backend 주요 파일
```
backend/src/
├── routes/
│   ├── cctvRoutes.ts
│   ├── UserRoutes.ts
│   ├── FavoriteRoutes.ts
│   └── ...
├── models/
│   ├── Camera/
│   ├── User/
│   └── ...
├── services/
│   ├── cctvService.ts
│   └── ...
└── socket.ts
```

---

## 화면 흐름도

```
시작
  ↓
로그인 페이지 (/auth/login)
  ↓ (로그인 성공)
홈 페이지 (/home)
  ↓
┌─────────────────┬─────────────────┬─────────────────┐
│                 │                 │                 │
대시보드          지도 페이지        CCTV 페이지
(/dashboard)      (/kakao-map)      (/favorite)
│                 │                 │
│                 │                 │
CCTV 선택        카카오맵 표시      즐겨찾기 CCTV
시간대 선택       CCTV 마커          영상 재생
차트 표시        영상 재생          분석 모드
                 이벤트 표시
```

---

**작성일**: 2024년
**버전**: 1.0
**프로젝트명**: Palantir (CCTV 모니터링 시스템)

